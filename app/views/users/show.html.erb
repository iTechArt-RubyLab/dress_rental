<% @user = current_user %>
<% @confirmed_rentals = @user.rentals.confirmed %>
<% @archived_rentals = @user.rentals.archived %>

<div class="container">
  <div class="row">
    <div class="col-md-4">
      <div class="card">
        <div class="card-body text-center">
        <%= link_to user_path(current_user.id) do %>
          <%= image_tag(current_user.avatar_url, alt: 'User avatar', class: 'rounded-circle', width: 150) %>
        <% end %>
          <h4 class="mt-3">John Doe</h4>
          <p class="text-muted">Full Stack Developer</p>
          <p class="text-muted">Bay Area, San Francisco, CA</p>
        </div>
      </div>
    </div>
    <div class="col-md-8">
      <div class="card">
        <div class="card-body">
          <div class="row">
            <div class="col-sm-3">
              <h6 class="mb-0">Full Name</h6>
            </div>
            <div class="col-sm-9 text-secondary">
              Kenneth Valdez
            </div>
          </div>
          <hr>
          <div class="row">
            <div class="col-sm-3">
              <h6 class="mb-0">Email</h6>
            </div>
            <div class="col-sm-9 text-secondary"><%= @user.email%></div>
          </div>
          <hr>
          <div class="row">
            <div class="col-sm-3">
              <h6 class="mb-0">Phone</h6>
            </div>
            <div class="col-sm-9 text-secondary"><%= @user.phone%></div>
          </div>
          <hr>
          <div class="row">
            <div class="col-sm-3">
              <h6 class="mb-0">Address</h6>
            </div>
            <div class="col-sm-9 text-secondary">
              (320) 380-4539
            </div>
          </div>
          <hr>
          <div class="row">
            <div class="col-sm-3">
              <h6 class="mb-0">Rating</h6>
            </div>
            <div class="col-sm-9 text-secondary"><%= @user.rating%> </div>
          </div>
          <hr>
          <div class="row">
            <div class="col-sm-12 text-right">
              <div class="form-inline">
                <%= link_to "Edit my account", edit_user_path(@user), class: "btn btn-primary mr-2"%>
                <%= form_with(url: request_owner_access_path, method: :post, html: {class: "d-inline-block"}) do |form| %>
                  <%= form.submit "Request owner rights", class: "btn btn-primary" %>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
      <% if @user.rentals.any? %>
        <div class="card">
          <div class="card-body">
            <h3 class="card-title">Rentals:</h3>
            <div class="table-responsive">
              <table class='table table-striped table-bordered'>
                <thead class='thead-dark'>
                  <tr>
                    <th>Product</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Total Price</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  <% @user.rentals.order(:status).each do |rental| %>
                    <tr>
                      <td><%= rental.product.name %></td>
                      <td><%= rental.start_date %></td>
                      <td><%= rental.end_date %></td>
                      <td><%= rental.total_price %> $</td>
                      <td><%= rental.status %></td>
                    </tr>
                  <% end %>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      <% end %>
</div>
